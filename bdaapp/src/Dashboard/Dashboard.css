/* ===== Global / base ===== */
/* Add this to <head> of public/index.html (VERY IMPORTANT for iPhone)
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
*/

html, body {
  height: 100%;
  min-height: 100dvh;               /* iOS friendly dynamic viewport */
  background: var(--bg-color);
}

:root {
  --bg-color: #faf5ff;
  --text-color: #333;
  --sidebar-bg: #ffffff;
  --sidebar-border: #e0d7ff;
  --primary-color: #9b5de5;
  --primary-hover: #7a42d1;
  --section-bg: #ffffff;
  --danger-color: #d93025;
  --danger-hover: #b31412;
  --modal-bg: #ffffff;
  --modal-shadow: rgba(0, 0, 0, 0.1);
  --input-border: #d3bfff;
  --input-bg: #fff;
  --button-text: #ffffff;
}

body.dark {
  --bg-color: #000000;
  --text-color: #ffffff;
  --sidebar-bg: #0f0f12;
  --sidebar-border: #ff69b4;
  --primary-color: #FA0787;
  --primary-hover: #d90673;
  --section-bg: #121216;
  --danger-color: #ff4d6d;
  --danger-hover: #d03456;
  --modal-bg: #1a1a1e;
  --modal-shadow: rgba(255, 20, 147, 0.15);
  --input-border: #ff69b4;
  --input-bg: #1f1f1f;
  --button-text: #ffffff;
}

/* ===== Typography & overflow safety ===== */
/* Prevent any text from spilling on narrow screens */
:where(h1,h2,h3,p,small,label,button,li,td,th,.section,.modal-content) {
  overflow-wrap: anywhere;          /* break long words/URLs */
  word-break: normal;
}

h2 { font-size: clamp(1.05rem, 2.2vw + 0.6rem, 1.6rem); }
h3 { font-size: clamp(1rem, 2vw + 0.5rem, 1.3rem); }
p, li, button, input, small { font-size: clamp(0.95rem, 1.2vw + 0.6rem, 1rem); }

/* ===== Layout ===== */
.drive-layout {
  display: grid;
  grid-template-columns: minmax(0, 240px) minmax(0, 1fr); /* minmax(0, …) fixes overflow in grid children */
  min-height: 100dvh;
  background: var(--bg-color);
  color: var(--text-color);
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
  box-sizing: border-box;
}

/* Ensure flex/grid children can actually shrink */
.content, .section, .nav, .sidebar, .button-row, .action-button-row { min-width: 0; }

/* Sidebar */
.sidebar {
  background: var(--sidebar-bg);
  border-right: 1px solid var(--sidebar-border);
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.nav button,
.sidebar-footer button {
  display: flex;
  align-items: center;
  gap: 8px;
  background: transparent;
  border: 1px solid var(--sidebar-border);
  color: var(--text-color);
  padding: 10px 12px;
  border-radius: 8px;
  cursor: pointer;
  width: 100%;
  min-height: 44px;                 /* finger-friendly */
  touch-action: manipulation;
  white-space: nowrap;              /* default: keep labels on one line */
  text-overflow: ellipsis;          /* but allow ellipsis if too long */
  overflow: hidden;
}

.nav button:hover,
.sidebar-footer button:hover { border-color: var(--primary-color); }

/* Main */
.content {
  padding: 16px 20px;
  -webkit-overflow-scrolling: touch;
  padding-bottom: calc(16px + env(safe-area-inset-bottom));
}

/* Buttons */
.action-button-row,
.button-row {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin: 10px 0 20px;
  justify-content: flex-start;
}

.action-btn,
.primary-btn {
  font-size: 14px;
  padding: 10px 12px;
  border-radius: 6px;
  background: var(--primary-color);
  color: var(--button-text);
  border: none;
  cursor: pointer;
  white-space: nowrap;
  min-height: 44px;
  touch-action: manipulation;
}

.action-btn:hover,
.primary-btn:hover { background: var(--primary-hover); }

/* Logout */
.logout-btn {
  padding: 10px 12px;
  background: #e57373;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 700;
  transition: background 0.3s ease;
  min-height: 44px;
  touch-action: manipulation;
}
.logout-btn:hover { background: #c62828; }

/* Delete */
.danger-btn {
  padding: 10px 12px;
  background: var(--danger-color);
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 700;
  transition: background 0.3s ease, transform 0.06s ease;
  border: 1px solid transparent;
  min-height: 44px;
  touch-action: manipulation;
}
.danger-btn:hover { background: var(--danger-hover); transform: translateY(-1px); }

/* Sections */
.section {
  background: var(--section-bg);
  border: 1px solid var(--sidebar-border);
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;
}
.danger-zone { border-color: var(--danger-color); }

/* Modals */
.modal-overlay {
  position: fixed; inset: 0;
  background: rgba(0,0,0,0.4);
  display: grid; place-items: center;
  z-index: 1000;
}
.modal-content {
  background: var(--modal-bg);
  border-radius: 12px;
  box-shadow: 0 12px 30px var(--modal-shadow);
  width: min(560px, 92vw);
  margin: 0 16px;
  padding: 14px;
  border: 1px solid var(--sidebar-border);
  max-height: min(86vh, 680px);     /* NEW: stop tall content from spilling */
  overflow: auto;                    /* and scroll inside the modal */
}
.modal-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 8px;
}
.modal-close { background: transparent; border: none; color: var(--text-color); cursor: pointer; }

/* Inputs */
input[type="text"], input[type="email"], input[type="password"] {
  width: 100%;
  padding: 12px;
  border: 2px solid var(--input-border);
  border-radius: 8px;
  background: var(--input-bg);
  color: var(--text-color);
  outline: none;
  margin-bottom: 10px;
}
.invalid-input { border-color: #ff4d6d !important; }
.error-message { color: #ff4d6d; font-size: 0.9rem; margin-bottom: 8px; }
.success-message { color: #29a36a; font-weight: 600; }

.password-instructions { margin: 0 0 10px; padding-left: 18px; }
.password-instructions li { line-height: 1.3; }

/* Strength pill */
.password-strength {
  font-size: 0.9rem;
  padding: 6px 10px;
  border-radius: 999px;
  display: inline-block;
  margin-bottom: 8px;
  border: 1px solid var(--sidebar-border);
}
.password-strength.weak { opacity: 0.7; }
.password-strength.moderate {opacity: 1;}
.password-strength.strong { border-color: var(--primary-color); }

/* ===== Responsive ===== */
@media (max-width: 1180px) {
  .drive-layout { grid-template-columns: minmax(0, 220px) minmax(0, 1fr); }
}

@media (max-width: 1024px) {
  .drive-layout { grid-template-columns: minmax(0, 200px) minmax(0, 1fr); }
}

@media (max-width: 820px) {
  .drive-layout { grid-template-columns: 1fr; }
  .sidebar {
    position: sticky;
    top: env(safe-area-inset-top);
    z-index: 4;
    border-right: none;
    border-bottom: 1px solid var(--sidebar-border);
    flex-direction: row;
    align-items: center;
    gap: 8px;
    overflow-x: auto;
    overflow-y: auto;               /* allow horizontal scroll for many buttons */
    padding-right: calc(12px + env(safe-area-inset-right));
    padding-left: calc(12px + env(safe-area-inset-left));
  }
  .nav { display: flex; gap: 8px; flex: 1; min-width: 0; }
  .sidebar-footer { display: flex; }
  .content { padding: 12px; }
}

/* iPhone 12/13/14/15 in portrait ~390–430px wide; also your 448×884 test */
@media (max-width: 520px) {
  /* Let labels wrap on small screens to avoid spill */
  .nav button, .sidebar-footer button,
  .primary-btn, .danger-btn, .logout-btn, .action-btn {
    white-space: normal;             /* was nowrap; now allowed to wrap */
  }
  .nav button svg, .sidebar-footer button svg { flex: 0 0 auto; }

  /* Slightly tighter paddings to buy space */
  .nav button, .sidebar-footer button { padding: 10px; }
  .primary-btn, .danger-btn, .logout-btn { width: 100%; }

  /* Keep headings from pushing layout */
  h2, h3 { letter-spacing: 0.1px; }
}

/* Super narrow Androids / SE / split screen */
@media (max-width: 360px) {
  .nav button, .sidebar-footer button { font-size: 0.9rem; }
}

